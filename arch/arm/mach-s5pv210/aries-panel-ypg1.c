/*
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the
 * Free Software Foundation; either version 2 of the License, or (at your
 * option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with this program; if not, write to the Free Software Foundation, Inc.,
 * 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 */
#include <linux/kernel.h>
#include <linux/types.h>
#include <linux/tl2796.h>
#include <linux/nt35580.h>
#include <mach/gpio.h>
#include <mach/gpio-ypg1.h>
#include <mach/gpio-ypg1-settings.h>

#define SLEEPMSEC		0x1000
#define ENDDEF			0x2000

static const u16 brightness_setting_table[] = {
	0x051, 0x17f,
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_DISPLAY_ON[] = {
	0x029,
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_DISPLAY_OFF[] = {
	0x028,
	SLEEPMSEC,	27, /* more than 25ms */
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_SETTING[] = {
	/* SET_PIXEL_FORMAT */
	0x3A,
	0x177,	/* 24 bpp */
	/* RGBCTRL */
	0x3B,
	/* RGB Mode1, DE is sampled at the rising edge of PCLK,
	* P-rising edge, EP- low active, HSP-low active, VSP-low active */
	0x107,
	0x10A,
	0x10E,
	0x10A,
	0x10A,
	/* SET_HORIZONTAL_ADDRESS (Frame Memory Area define) */
	0x2A,
	0x100,
	0x100,
	0x101,	/* 480x800 */
	0x1DF,	/* 480x800 */
	/* SET_VERTICAL_ADDRESS  (Frame Memory Area define) */
	0x2B,
	0x100,
	0x100,
	0x103,	/* 480x800 */
	0x11F,	/* 480x800 */
	/* SET_ADDRESS_MODE */
	0x36,
	0x1D4,
	SLEEPMSEC, 30,	/* recommend by Sony-LCD, */
	/* SLPOUT */
	0x11,
	SLEEPMSEC, 155, /* recommend by Sony */
	/* WRCTRLD-1 */
	0x55,
	0x100,	/* CABC Off   1: UI-Mode, 2:Still-Mode, 3:Moving-Mode */
	/* WRCABCMB */
	0x5E,
	/* Minimum Brightness Value Setting 0:the lowest, 0xFF:the highest */
	0x100,
	/* WRCTRLD-2 */
	0x53,
	/* BCTRL(1)-PWM Output Enable, A(0)-LABC Off,
	* DD(1)-Enable Dimming Function Only for CABC,
	* BL(1)-turn on Backlight Control without dimming effect */
	0x12C,
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_SLEEP_IN[] = {
	0x010,
	SLEEPMSEC, 155,  /* more than 150ms */
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_CABC_OFF[] = {
	0x055, 0x100,
	SLEEPMSEC, 	200,
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_CABC_UI[] = {
	0x055, 0x101,
	SLEEPMSEC, 	200,
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_CABC_IMAGE[] = {
	0x055, 0x102,
	SLEEPMSEC, 	200,
	ENDDEF, 0x0000
};

static const u16 nt35580_SEQ_CABC_VIDEO[] = {
	0x055, 0x103,
	SLEEPMSEC, 	200,
	ENDDEF, 0x0000
};

static void tft_backlight_on(int enable)
{
	printk("[%s] %d\n", __func__, enable);

	if(enable)
	{
		if (gpio_is_valid(GPIO_BACKLIGHT_EN))
		{
				if (gpio_request(GPIO_BACKLIGHT_EN, "GPD0"))
						printk("Failed to request GPIO_BACKLIGHT_EN!\n");

				s3c_gpio_cfgpin(GPIO_BACKLIGHT_EN, S3C_GPIO_OUTPUT);
				gpio_direction_output(GPIO_BACKLIGHT_EN, (int)1);
		}
		s3c_gpio_setpull(GPIO_BACKLIGHT_EN, S3C_GPIO_PULL_NONE);
		gpio_free(GPIO_BACKLIGHT_EN);

	}
	else
	{
		if (gpio_is_valid(GPIO_BACKLIGHT_EN))
		{
				if (gpio_request(GPIO_BACKLIGHT_EN, "GPD0"))
						printk("Failed to request GPIO_BACKLIGHT_EN!\n");

				s3c_gpio_cfgpin(GPIO_BACKLIGHT_EN, S3C_GPIO_OUTPUT);
				gpio_direction_output(GPIO_BACKLIGHT_EN, (int)0);
		}
		s3c_gpio_setpull(GPIO_BACKLIGHT_EN, S3C_GPIO_PULL_NONE);
		gpio_free(GPIO_BACKLIGHT_EN);
	}
}


struct s5p_tft_panel_data aries_sony_panel_data = {
	.seq_set = nt35580_SEQ_SETTING,
	.sleep_in = nt35580_SEQ_SLEEP_IN,
	.display_on = nt35580_SEQ_DISPLAY_ON,
	.display_off = nt35580_SEQ_DISPLAY_OFF,
	.cur_vendor = LCD_SONY,
	.brightness_set = brightness_setting_table,
	.seq_cabc_ui = nt35580_SEQ_CABC_UI,
	.seq_cabc_video = nt35580_SEQ_CABC_VIDEO,
	.seq_cabc_image = nt35580_SEQ_CABC_IMAGE,
	.seq_cabc_off = nt35580_SEQ_CABC_OFF,
	.pwm_reg_offset = 1,
	.backlight_on = tft_backlight_on,
};

/* Hydis Panel (nt35510) */
static const u16 nt35510_SEQ_SETTING[] = {
	0xFF,
	0x1AA,
	0x155,
	0x125,
	0x101,

	0xF3,
	0x100,
	0x132,
	0x100,
	0x138,
	0x131,
	0x108,
	0x111,
	0x100,

	/* Enable CMD2_Page1 */
	0xF0,
	0x155,
	0x1AA,
	0x152,
	0x108,
	0x100,

	0xB0,
	0x104,
	0x10A,
	0x10E,
	0x109,
	0x104,

	0xB1,
	0x1CC,
	0x104,

	0x36, 0x102,
	0xB3, 0x100,

	/* AVDD */
	0xB6,
	0x103,

	0xB7,
	0x170,
	0x170,

	0xB8,
	0x100,
	0x106,
	0x106,
	0x106,

	0xBC,
	0x100,
	0x100,
	0x100,

	0xBD,
	0x101,
	0x184,
	0x106,
	0x150,
	0x100,

	0xCC,
	0x103,
	0x101,
	0x106,

	0xF0,
	0x155,
	0x1AA,
	0x152,
	0x108,
	0x101,

	0xB0,
	0x105,
	0x105,
	0x105,

	0xB1,
	0x105,
	0x105,
	0x105,

	0xB2,
	0x103,
	0x103,
	0x103,

	0xB8,
	0x125,
	0x125,
	0x125,

	0xB3,
	0x10B,
	0x10B,
	0x10B,

	0xB9,
	0x134,
	0x134,
	0x134,

	/* VGH */
	0xBF,
	0x101,

	0xB5,
	0x108,
	0x108,
	0x108,

	/* VGL */
	0xBA,
	0x124,
	0x124,
	0x124,

	0xB4,
	0x12E,
	0x12E,
	0x12E,

	0xBC,
	0x100,
	0x150,
	0x100,

	0xBD,
	0x100,
	0x160,
	0x100,

	0xBE,
	0x100,
	0x140,

	/*Test commands H/W Request*/
	0xCE,
	0x100,
	0x100,
	0x100,
	0x100,
	0x100,
	0x100,
	0x100,

	0xD0,
	0x109,
	0x114,
	0x107,
	0x10D,

	0xD1,
	0x100,
	0x137,
	0x100,
	0x161,
	0x100,
	0x192,
	0x100,
	0x1B4,
	0x100,
	0x1CF,
	0x101,
	0x106,
	0x101,
	0x141,
	0x101,
	0x18A,
	0x101,
	0x1A6,
	0x101,
	0x1D1,
	0x102,
	0x101,
	0x102,
	0x13D,
	0x102,
	0x177,
	0x102,
	0x179,
	0x102,
	0x1A5,
	0x102,
	0x1D1,
	0x102,
	0x1F9,
	0x103,
	0x125,
	0x103,
	0x143,
	0x103,
	0x16E,
	0x103,
	0x177,
	0x103,
	0x194,
	0x103,
	0x19F,
	0x103,
	0x1AC,
	0x103,
	0x1BA,
	0x103,
	0x1F1,

	0xD2,
	0x100,
	0x137,
	0x100,
	0x161,
	0x100,
	0x192,
	0x100,
	0x1B4,
	0x100,
	0x1CF,
	0x101,
	0x106,
	0x101,
	0x141,
	0x101,
	0x18A,
	0x101,
	0x1A6,
	0x101,
	0x1D1,
	0x102,
	0x101,
	0x102,
	0x13D,
	0x102,
	0x177,
	0x102,
	0x179,
	0x102,
	0x1A5,
	0x102,
	0x1D1,
	0x102,
	0x1F9,
	0x103,
	0x125,
	0x103,
	0x143,
	0x103,
	0x162,
	0x103,
	0x177,
	0x103,
	0x194,
	0x103,
	0x19F,
	0x103,
	0x1AC,
	0x103,
	0x1BA,
	0x103,
	0x1F1,

	0xD3,
	0x100,
	0x137,
	0x100,
	0x161,
	0x100,
	0x192,
	0x100,
	0x1B4,
	0x100,
	0x1CF,
	0x101,
	0x106,
	0x101,
	0x141,
	0x101,
	0x18A,
	0x101,
	0x1A6,
	0x101,
	0x1D1,
	0x102,
	0x101,
	0x102,
	0x13D,
	0x102,
	0x177,
	0x102,
	0x179,
	0x102,
	0x1A5,
	0x102,
	0x1D1,
	0x102,
	0x1F9,
	0x103,
	0x125,
	0x103,
	0x143,
	0x103,
	0x16E,
	0x103,
	0x177,
	0x103,
	0x194,
	0x103,
	0x19F,
	0x103,
	0x1AC,
	0x103,
	0x1BA,
	0x103,
	0x1F1,

	0xD4,
	0x100,
	0x137,
	0x100,
	0x150,
	0x100,
	0x189,
	0x100,
	0x1A9,
	0x100,
	0x1C0,
	0x101,
	0x106,
	0x101,
	0x126,
	0x101,
	0x154,
	0x101,
	0x179,
	0x101,
	0x1B8,
	0x101,
	0x1DF,
	0x102,
	0x12F,
	0x102,
	0x168,
	0x102,
	0x16A,
	0x102,
	0x1A3,
	0x102,
	0x1E0,
	0x102,
	0x1F9,
	0x103,
	0x125,
	0x103,
	0x143,
	0x103,
	0x16E,
	0x103,
	0x177,
	0x103,
	0x194,
	0x103,
	0x19F,
	0x103,
	0x1AC,
	0x103,
	0x1BA,
	0x103,
	0x1F1,

	0xD5,
	0x100,
	0x137,
	0x100,
	0x150,
	0x100,
	0x189,
	0x100,
	0x1A9,
	0x100,
	0x1C0,
	0x101,
	0x106,
	0x101,
	0x126,
	0x101,
	0x154,
	0x101,
	0x179,
	0x101,
	0x1B8,
	0x101,
	0x1DF,
	0x102,
	0x12F,
	0x102,
	0x168,
	0x102,
	0x16A,
	0x102,
	0x1A3,
	0x102,
	0x1E0,
	0x102,
	0x1F9,
	0x103,
	0x125,
	0x103,
	0x143,
	0x103,
	0x16E,
	0x103,
	0x177,
	0x103,
	0x194,
	0x103,
	0x19F,
	0x103,
	0x1AC,
	0x103,
	0x1BA,
	0x103,
	0x1F1,

	0xD6,
	0x100,
	0x137,
	0x100,
	0x150,
	0x100,
	0x189,
	0x100,
	0x1A9,
	0x100,
	0x1C0,
	0x101,
	0x106,
	0x101,
	0x126,
	0x101,
	0x154,
	0x101,
	0x179,
	0x101,
	0x1B8,
	0x101,
	0x1DF,
	0x102,
	0x12F,
	0x102,
	0x168,
	0x102,
	0x16A,
	0x102,
	0x1A3,
	0x102,
	0x1E0,
	0x102,
	0x1F9,
	0x103,
	0x125,
	0x103,
	0x143,
	0x103,
	0x16E,
	0x103,
	0x177,
	0x103,
	0x194,
	0x103,
	0x19F,
	0x103,
	0x1AC,
	0x103,
	0x1BA,
	0x103,
	0x1F1,

/*
	0xF0,
	0x155,
	0x1AA,
	0x152,
	0x108,
	0x100,

*/
// Sleep out
	0x11,
// PWM
	0x51,	0x106,
	0x53,	0x102,
// Display on
	0x29,

	ENDDEF, 0x0000
};

static const u16 nt35510_SEQ_DISPLAY_ON[] = {
	0x53, 0x12C,
	0x11,
	SLEEPMSEC, 120,
	0x29,
	ENDDEF, 0x0000
};

static const u16 nt35510_SEQ_DISPLAY_OFF[] = {
	0x28,
	SLEEPMSEC, 27,
	ENDDEF, 0x0000
};
static const u16 nt35510_SEQ_SLEEP_IN[] = {
	0x10,
	SLEEPMSEC, 155,  /* more than 150ms */
	ENDDEF, 0x0000
};

struct s5p_tft_panel_data aries_hydis_panel_data = {
	.seq_set = nt35510_SEQ_SETTING,
	.display_on = nt35510_SEQ_DISPLAY_ON,
	.sleep_in = nt35510_SEQ_SLEEP_IN,
	.display_off = nt35510_SEQ_DISPLAY_OFF,
	.cur_vendor = LCD_HYDIS,
	.brightness_set = brightness_setting_table,
	.seq_cabc_ui = nt35580_SEQ_CABC_UI,
	.seq_cabc_video = nt35580_SEQ_CABC_VIDEO,
	.seq_cabc_image = nt35580_SEQ_CABC_IMAGE,
	.seq_cabc_off = nt35580_SEQ_CABC_OFF,
	.pwm_reg_offset = 1,
	.backlight_on = tft_backlight_on,
};

/* hitachi panel (R61408) */
static const u16 R61408_SEQ_SETTING[] = {
	0x36, 0x100,
	0x3A, 0x177,

	0x11,
	SLEEPMSEC, 150,

	0xB0, 0x104,
	0xC1, 0x142,
	0x131, 0x104,
	0xB0, 0x103,
	ENDDEF, 0x0000
};

static const u16 R61408_SEQ_DISPLAY_ON[] = {
	0x29,
	ENDDEF, 0x0000
};

static const u16 R61408_SEQ_DISPLAY_OFF[] = {
	0xB0, 0x104,
	0xB1, 0x101,
	SLEEPMSEC, 2,
	ENDDEF, 0x0000
};
static const u16 R61408_SEQ_SLEEP_IN[] = {
	0x28,            /* Display off cmd*/
	ENDDEF, 0x0000,

	0x10,
	SLEEPMSEC, 150,  /* more than 150ms */
	ENDDEF, 0x0000
};

static const u16 R61408_brightness_setting_table[] = {
	0xB0, 0x102,
	0xB9, 0x100,
	0x1F7, 0x102,
	0x108,
	0xB0, 0x103,
	ENDDEF, 0x0000
};
struct s5p_tft_panel_data aries_hitachi_panel_data = {
	.seq_set = R61408_SEQ_SETTING,
	.display_on = R61408_SEQ_DISPLAY_ON,
	.sleep_in = R61408_SEQ_SLEEP_IN,
	.display_off = R61408_SEQ_DISPLAY_OFF,
	.cur_vendor = LCD_HITACHI,
	.brightness_set = R61408_brightness_setting_table,
	.seq_cabc_ui = nt35580_SEQ_CABC_UI,
	.seq_cabc_video = nt35580_SEQ_CABC_VIDEO,
	.seq_cabc_image = nt35580_SEQ_CABC_IMAGE,
	.seq_cabc_off = nt35580_SEQ_CABC_OFF,
	.pwm_reg_offset = 4,
	.backlight_on = tft_backlight_on,
};

